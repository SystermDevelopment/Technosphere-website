<?php
$page_title = 'AI Ã— ç”»åƒèªè­˜ã§æ¥­å‹™åŠ¹ç‡åŒ–ï½œæ ªå¼ä¼šç¤¾ãƒ†ã‚¯ãƒã‚¹ãƒ•ã‚£ã‚¢';
$page_desc  = 'å¤§é˜ªç™ºã®ã‚·ã‚¹ãƒ†ãƒ é–‹ç™ºä¼šç¤¾ãƒ†ã‚¯ãƒã‚¹ãƒ•ã‚£ã‚¢ã¯ã€ç”»åƒèªè­˜ãƒ»RAG ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆãƒ»ã‚¨ãƒƒã‚¸ AI ã¾ã§ä¸€è²«å¯¾å¿œã€‚è¦ä»¶å®šç¾©ã‹ã‚‰é‹ç”¨ã¾ã§ãƒ¯ãƒ³ã‚¹ãƒˆãƒƒãƒ—ã§æ”¯æ´ã—ã¾ã™ã€‚';
include 'header.php';
?>
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AIãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆç‰¹è¨­ãƒšãƒ¼ã‚¸</title>
  <style>
    body { font-family: sans-serif; margin: 0; padding: 0; line-height: 1.6; background: #e6faff; }
    header { background: #67d8bd; color: white; padding: 30px 20px; text-align: center; }
    section { padding: 40px 20px; max-width: 1200px; margin: auto; }
    h2 { margin-bottom: 20px; border-left: 8px solid #67d8bd; padding-left: 10px; color: #006666; }
    .case-list { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; }
    .case { width: 280px; text-align: center; background: #ffffff; border: 1px solid #b2ebf2; border-radius: 10px; padding: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.05); }
    .case img { width: 100%; border-radius: 8px; }
    iframe { width: 100%; max-width: 600px; height: 400px; border: 1px solid #ccc; border-radius: 8px; display: block; margin: auto; }
    .diagram { max-width: 800px; margin: 20px auto; display: block; border-radius: 10px; }
    .cta-button {
      display: inline-block; margin-top: 30px; padding: 15px 30px;
      background: #67d8bd; color: white; font-weight: bold; border-radius: 6px;
      text-decoration: none; font-size: 18px;
    }
    .message {
      padding: 8px 12px;
      margin: 5px 0;
      border-radius: 10px;
      display: inline-block;
      max-width: 80%;
      clear: both;
    }
    
    .user {
      background: #c8f7f0;
      float: left;
      text-align: right;
    }
    
    .ai {
      background: #f0f0f0;
      float: right;
      text-align: right;
    }
    
    #chatbox {
      background:#fff; padding:15px; border-radius:10px;
      border:1px solid #ccc; max-width:600px; margin:auto;
    }

    #demo-iframe {
      max-width: 800px;
    }
    
    #chat-log {
      min-height:200px; max-height:300px; overflow-y:auto;
      margin-bottom:10px; padding-right:5px;
    }
    
    .chat-input { display:flex; gap:5px; }
    .chat-input input { flex:1; padding:8px; }
    .chat-input button { padding:8px 16px; }
    
    footer {
      text-align: center; padding: 20px;
      font-size: 0.9em; color: #555; background: #ccf2f4;
    }
  </style>
</head>
<body>
  <header>
    <h1>AIãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆç‰¹è¨­ãƒšãƒ¼ã‚¸</h1>
    <p>ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ãƒ»è¨­è¨ˆæ›¸ãƒ»FAQã«å›ç­”ã™ã‚‹æ¬¡ä¸–ä»£AI</p>
  </header>

  <section id="service">
    <h2>ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã§ã§ãã‚‹ã“ã¨</h2>
    <p>
      æœ¬ã‚·ã‚¹ãƒ†ãƒ ã¯ã€ä¼æ¥­å†…ã®ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ãƒ»FAQãƒ»è¨­è¨ˆæ›¸ãªã©ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’AIã«èª­ã¿è¾¼ã¾ã›ã‚‹ã“ã¨ã§ã€å•ã„åˆã‚ã›å¯¾å¿œã‚’åŠ¹ç‡åŒ–ã™ã‚‹ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚
      Retrieval-Augmented Generationï¼ˆRAGï¼‰æ§‹æˆã‚’æ¡ç”¨ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®è³ªå•ã«å¯¾ã—ã¦è©²å½“ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ¤œç´¢ã—ã€GPTãƒ™ãƒ¼ã‚¹ã®AIãŒè‡ªç„¶ãªæ–‡ç« ã§å›ç­”ã‚’ç”Ÿæˆã—ã¾ã™ã€‚
      æ“ä½œãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã®æ¤œç´¢æ”¯æ´ã€éå»Q&Aã®è‡ªå‹•å¯¾å¿œã€é–‹ç™ºãƒãƒ¼ãƒ å‘ã‘ã®æŠ€è¡“çš„ãªå•åˆã›å¯¾å¿œãªã©ã€ã•ã¾ã–ã¾ãªæ¥­å‹™ã§æ´»ç”¨ãŒå¯èƒ½ã§ã™ã€‚
      Slackã¨ã®é€£æºã«ã‚ˆã‚‹æ‰‹å‹•è¿”ä¿¡ã‚„ã€å°†æ¥çš„ãªè‡ªå‹•å¿œç­”ã¸ã®æ‹¡å¼µã«ã‚‚å¯¾å¿œã—ã¦ãŠã‚Šã€æŸ”è»Ÿã‹ã¤å®Ÿè·µçš„ãªAIæ´»ç”¨ãŒå¯èƒ½ã§ã™ã€‚
    </p>
  </section>

  <section id="cases">
    <h2>å°å…¥äº‹ä¾‹</h2>
    <div class="case-list">
      <div class="case">
        <img src="/assets/img/case_manual_ai.png" alt="æ“ä½œãƒãƒ‹ãƒ¥ã‚¢ãƒ«å¯¾å¿œ">
        <p>ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§ã€ä½¿ã„æ–¹ã«ãƒãƒ£ãƒƒãƒˆã§å›ç­”</p>
      </div>
      <div class="case">
        <img src="/assets/img/case_faq_ai.png" alt="FAQè‡ªå‹•å¿œç­”">
        <p>ã‚³ãƒ¼ãƒ«ã‚»ãƒ³ã‚¿ãƒ¼ã®éå»Q&Aã‚’å­¦ç¿’ã—è‡ªå‹•å¿œç­”</p>
      </div>
      <div class="case">
        <img src="/assets/img/case_system_design_ai.png" alt="é–‹ç™ºè¨­è¨ˆæ›¸å¿œç­”">
        <p>ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆæ›¸ã‚’èª­ã¿è¾¼ã‚“ã§æŠ€è¡“çš„ãªå•ã„åˆã‚ã›ã«å›ç­”</p>
      </div>
    </div>
  </section>

  <section id="demo">
    <h2>ãƒ‡ãƒ¢ãƒãƒ£ãƒƒãƒˆ</h2>
    <!-- <div id="chatbox">
      <div id="chat-log"></div>
      <div class="chat-input">
        <input id="user-input" type="text" placeholder="ã“ã“ã«å…¥åŠ›...">
        <button onclick="sendMessage()">é€ä¿¡</button>
      </div>
    </div> -->
    <iframe id="demo-iframe" src="http://15.168.31.47:8501/"></iframe>
  </section>

  <section id="how">
    <h2>AIã®ä»•çµ„ã¿ï¼ˆRAGæ§‹æˆï¼‰</h2>
    <p>å½“ç¤¾ã®ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã¯ã€äº‹å‰ã«èª­ã¿è¾¼ã‚“ã ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆãƒãƒ‹ãƒ¥ã‚¢ãƒ«ãƒ»FAQãƒ»è¨­è¨ˆæ›¸ï¼‰ã‚’ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ã—ã€GPTã‚’ä½¿ã£ã¦æœ€é©ãªå›ç­”ã‚’ç”Ÿæˆã—ã¾ã™ã€‚</p>
    <img class="diagram" src="/assets/img/rag_structure.png" alt="RAGæ§‹æˆã®å›³è§£">
  </section>

  <footer>
    &copy; 2025 Technosphere co.,ltd All rights reserved.
  </footer>

  <script>
    const endpoint = "https://chat.technosphere.co.jp";

    function sendMessage() {
      const input = document.getElementById("user-input");
      const log = document.getElementById("chat-log");
      const userText = input.value.trim();
      if (!userText) return;

      const name = "Webãƒ¦ãƒ¼ã‚¶ãƒ¼";

      const userMessage = document.createElement("div");
      userMessage.className = "message user";
      userMessage.textContent = "ã‚ãªãŸ: " + userText;
      log.appendChild(userMessage);

      fetch(`${endpoint}/api/chat`, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "ngrok-skip-browser-warning": "true"
        },
        body: JSON.stringify({ name, message: userText })
      }).then(res => {
        const replyMessage = document.createElement("div");
        replyMessage.className = "message ai";
        replyMessage.textContent = "AI: ã”è³ªå•ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚ï¼¡ï¼©ãŒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ç¢ºèªä¸­ã§ã™ã€‚";
        log.appendChild(replyMessage);
        log.scrollTop = log.scrollHeight;
      }).catch(err => {
        const errorMessage = document.createElement("div");
        errorMessage.className = "message ai";
        errorMessage.textContent = "AI: é€šä¿¡ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚";
        log.appendChild(errorMessage);
      });

      input.value = "";
    }

    // ğŸ” è¿”ä¿¡ã‚’10ç§’ãŠãã«å–å¾—
    let firstPoll = true;
    
    setInterval(() => {
      fetch(`${endpoint}/api/reply`, {
        headers: { "ngrok-skip-browser-warning": "true" }
      })
        .then(res => res.json())
        .then(data => {
          if (data.text && (!window.lastDisplayed || data.timestamp !== window.lastDisplayed)) {
            if (firstPoll) {
              // åˆå›ã¯è¡¨ç¤ºã›ãšã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã ã‘æ›´æ–°
              window.lastDisplayed = data.timestamp;
              firstPoll = false;
              return;
            }
    
            const replyDiv = document.createElement("div");
            replyDiv.className = "message ai";
            replyDiv.textContent = "AIè¿”ä¿¡: " + data.text;
            document.getElementById("chat-log").appendChild(replyDiv);
            window.lastDisplayed = data.timestamp;
          }
        });
    }, 10000);

    document.getElementById("user-input").addEventListener("keydown", function(event) {
      if (event.key === "Enter") {
        event.preventDefault(); // æ”¹è¡Œã‚’é˜²ã
        sendMessage(); // é€šå¸¸ã®é€ä¿¡å‡¦ç†
      }
    });

  </script>
</body>
</html>
